# 제품 요구사항 명세서 (PRD): 한세로

> v.0.0.1 | 2025.12

---

## 1. 개요 (Overview)

**한세로**는 산본역/금정역에서 한세대학교로 통학하는 학생들을 위한 **택시 카풀 매칭 서비스**입니다.

같은 시간대, 같은 방향으로 이동하는 학생들을 매칭하여 택시 합승을 지원하고, 교통비 절감과 안전하고 편리한 통학 환경을 제공하는 것을 목표로 합니다.

---

## 2. 달성 목표 (Metric)

- **목표**: 통학 학생들의 교통비 절감 및 매칭 편의성 제공
- **핵심 평가 지표 (Key Metrics)**:
    - **MAU (Monthly Active Users)**: 월간 활성 사용자 수 50~100명
    - **매칭 성공률**: 매칭 요청 대비 성공 비율
    - **평균 대기 시간**: 매칭 요청 후 완료까지 소요 시간

---

## 3. 목적 및 범위

### 3.1 목적
- 산본역/금정역 → 한세대학교 통학 학생들의 **교통비 절감**
- 같은 시간대, 같은 방향 학생들을 **매칭하여 택시 합승 지원**
- **안전하고 편리한 통학 환경** 제공

### 3.2 범위

| 구분 | 내용 |
|------|------|
| **포함** | 회원가입/로그인, 매칭 요청/응답, 출발지 선택, 채팅, 평가 |
| **제외** | 결제 시스템, 실시간 위치 추적, 일반 택시 호출 |

---

## 4. 기술 스택 (Tech Stacks)

### 언어 및 프레임워크
- **Java**: 17
- **Spring Boot**: 3.5.7
- **Gradle**: 빌드 도구

### 데이터베이스
- **MySQL**: 운영 RDB

### 주요 라이브러리
- **Spring Security**: 인증/인가
- **Spring Data JPA**: ORM
- **MapStruct**: DTO 매핑
- **Swagger (springdoc-openapi)**: API 문서화
- **Lombok**: 보일러플레이트 코드 제거

---

## 5. 핵심 기능 명세

### 5.1 사용자 흐름 (User Flow)
```
랜딩페이지 → 로그인/회원가입 → 메인페이지 → 출발지 선택(산본역/금정역) 
→ 매칭 대기열 → 매칭 완료/실패 → 완료페이지
```

### 5.2 MVP

- **P0: 매칭 시스템**: 출발지 선택 후 실시간 매칭 대기열 등록 및 자동 매칭
- **P1: 버스 정보 제공**: 날씨/시간대별 예상 소요시간 계산 및 대안 교통수단 안내
- **P2: 채팅 기능**: 매칭된 팀원 간 실시간 채팅

### 5.3 주요 요구사항

#### 5.3.1 회원 (User)
- **(P0) 회원가입/로그인**: 이메일 기반 회원가입 및 로그인
- **(P1) 프로필 관리**: 이름, 학과 등 기본 정보 관리

#### 5.3.2 매칭 (Matching)
- **(P0) 매칭 요청**: 출발지(산본역/금정역) 선택 후 매칭 대기열 등록
- **(P0) 매칭 대기열**: 실시간 대기 인원 수 표시, 대기자 목록 확인
- **(P0) 매칭 완료**: 매칭 성공 시 팀원 정보 제공
- **(P1) 매칭 실패 처리**: 다른 교통수단(버스 등) 안내

#### 5.3.3 버스 노선 (Bus Route)
- **(P1) 버스 정보 제공**: 산본역/금정역 → 학교 가는 버스 목록
- **(P1) 소요 시간 계산**: 날씨, 시간대별 예상 소요 시간 제공

#### 5.3.4 매칭룸 (Matching Room)
- **(P0) 매칭룸 생성**: 매칭 완료 시 자동 생성
- **(P1) 매칭룸 만료**: 일정 시간 후 자동 만료

#### 5.3.5 채팅 (Chat)
- **(P2) 실시간 채팅**: 매칭된 팀원 간 메시지 송수신
- **(P2) 채팅방 관리**: 매칭룸 기반 채팅방 자동 생성/삭제

---

## 6. 도메인 모델

### 6.1 User (사용자)

| 필드 | 타입 | 설명 |
|------|------|------|
| user_id | BIGINT | PK |
| email | VARCHAR(100) | 이메일 |
| name | VARCHAR(50) | 이름 |
| major | VARCHAR(50) | 학과 |
| created_at | DATETIME | 생성일시 |

### 6.2 Matching Room (매칭룸)

| 필드 | 타입 | 설명 |
|------|------|------|
| matching_id | BIGINT | PK |
| destination | VARCHAR(100) | 목적지 |
| created_at | DATETIME | 생성일시 |
| expires_at | DATETIME | 만료일시 |
| status | VARCHAR(20) | 상태 |

### 6.3 Room Participant (매칭 참여자)

| 필드 | 타입 | 설명 |
|------|------|------|
| participant_id | BIGINT | PK |
| user_id | BIGINT | FK (User) |
| matching_id | BIGINT | FK (Matching Room) |
| joined_at | DATETIME | 참여일시 |

### 6.4 Bus Route (버스 노선)

| 필드 | 타입 | 설명 |
|------|------|------|
| bus_route_id | BIGINT | PK |
| route_number | VARCHAR(10) | 노선 번호 |
| start_station | VARCHAR(50) | 출발 정류장 |
| station_id | VARCHAR(20) | 정류장 ID |
| base_duration | INT | 기본 소요시간(분) |
| created_at | DATETIME | 생성일시 |

### 6.5 Travel Time Factor (소요시간 변수)

| 필드 | 타입 | 설명 |
|------|------|------|
| travel_time_factor_id | BIGINT | PK |
| bus_route_id | BIGINT | FK (Bus Route) |
| route_id | BIGINT | 노선 ID |
| weather_type | VARCHAR(20) | 날씨 유형 |
| time_slot | VARCHAR(20) | 시간대 |
| avg_duration | INT | 평균 소요시간 |
| sample_count | INT | 샘플 수 |
| updated_at | DATETIME | 수정일시 |

### 6.6 Travel Log (이동 기록)

| 필드 | 타입 | 설명 |
|------|------|------|
| travel_log_id | BIGINT | PK |
| bus_route_id | BIGINT | FK (Bus Route) |
| route_id | BIGINT | 노선 ID |
| weather_type | VARCHAR(20) | 날씨 유형 |
| time_slot | VARCHAR(20) | 시간대 |
| actual_duration | INT | 실제 소요시간 |
| logged_at | DATETIME | 기록일시 |

---

## 7. 페이지 구성

### 7.1 메인페이지
- 헤어링을 하실건가요? (파티 만들기, 참가하기)
- 선착순으로 그날 산본역/금정역 랜덤매칭
- 출발지 선택 (산본역/금정역)
- 현재 날씨 및 예상 소요시간 표시
- 버스 목록 및 전철 도착 정보

### 7.2 매칭 대기열
- 택시를 타야하는 사람들의 수 표시
- 대기 인원 목록 (체크 표시)
- 애니메이션 캐릭터 (오토바이 타고 움직이는 등)
- "이 인원으로라도 택시 타기" 버튼

### 7.3 매칭 실패 페이지
- 실패한 이유
- 울고있는 캐릭터
- 다시 매칭하기 / 다른 교통수단(버스 등) 이용하기

### 7.4 매칭 완료 페이지
- 팀장/팀원이 보는 페이지 구분
- 팀원 목록 표시
- 20,000원 정도 적용 4등분 안내

---

## 8. 비기능적 요구사항

### 8.1 보안
- Spring Security 기반 인증/인가
- JWT 토큰 기반 세션 관리

### 8.2 API 문서화
- Swagger UI를 통한 API 명세 자동 생성

### 8.3 코드 품질
- Spotless를 통한 코드 포맷팅 관리

---

## 9. 향후 확장 계획

- [ ] 결제 시스템 연동
- [ ] 실시간 위치 추적
- [ ] 사용자 평가 시스템
- [ ] 푸시 알림
- [ ] 정기 매칭 (같은 시간대 반복 매칭)